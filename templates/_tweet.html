<article class="post" id="post_{{ tweet.post_pk }}" mix-fade-in="5000">
    <img src="{{ url_for('static', filename='images/user_avatars/'~(tweet.user_avatar_path if tweet.user_avatar_path else 'unknown.jpg')) }}"
        alt="Profile Picture" class="w-8 h-8 rounded-full">
    <div class="post-content">
        <div class="post-header">
            <span class="name">
                {{ tweet.user_first_name }}
                {{ tweet.user_last_name }}
            </span>
            <span class="handle">@{{ tweet.user_username }}</span> Â· <span class="time">1d</span>
        </div>

        {% if session.user and session.user.user_pk == tweet.post_user_fk %}
        <a href="{{ url_for('delete_post', post_pk=tweet.post_pk) }}" class="cursor-pointer text-c-black" mix-delete
            mix-remove="#post_{{ tweet.post_pk }}">
            <i class="fa-solid fa-trash pointer-e-none"></i>
        </a>

        <a href="{{ url_for('edit_post', post_pk=tweet.post_pk) }}" class="cursor-pointer text-c-black" mix-get
            mix-update="#post_{{ tweet.post_pk }}">
            <i class="fa-solid fa-pen pointer-e-none"></i>
        </a>
        {% endif %}

        <p class="text">
            {{ tweet.post_message }}
        </p>
        {% if tweet.post_image_path: %}
        <img src="{{ url_for('static', filename='images/post_images/' ~ tweet.post_image_path) }}" alt="Post image"
            class="w-80">
        {% endif %}

        <div class="post-actions">
            <span class="action comment-toggle" data-target="comment_box_{{ post_pk }}"><i
                    class="fa-regular fa-comment"></i> {{ tweet.post_total_comments }} </span>

            <span class="action"><i class="fa-solid fa-retweet"></i> 5</span>

            <div id="like_container_{{ tweet.post_pk }}">
                <form method="post" class="action cursor-pointer" mix-post="{{ url_for('like_toggle') }}">
                    <input type="hidden" name="post_pk" value="{{ tweet.post_pk }}">
                    <button type="submit" class="action pointer-e-none">

                        <span id="like_icon_{{ tweet.post_pk }}" class="pointer-e-none">
                            {% if tweet.user_liked %}
                            <i class="fa-solid fa-heart"></i>
                            {% else %}
                            <i class="fa-regular fa-heart"></i>
                            {% endif %}
                        </span>

                        <span id="like_count_{{ tweet.post_pk }}">
                            {{ tweet.post_total_likes }}
                        </span>
                    </button>
                </form>
            </div>

            <span class="action"><i class="fa-solid fa-chart-simple"></i> 230</span>
            <span class="action"><i class="fa-solid fa-share"></i></span>
        </div>

        <div id="comments_list_{{ tweet.post_pk }}" class="">
            {% if tweet.comments %}
            {% for comment in tweet.comments %}
            <div class="d-flex pt-5">
                <img src="{{ url_for('static', filename='images/user_avatars/' ~ (comment.user_avatar_path or 'unknown.jpg')) }}"
                    class="me-2 w-6 h-6 rounded-full">
                <div class="">
                    <span>@{{ comment.user_username }}</span>
                    <p>{{ comment.comment_message }}</p>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
</article>


<div class="post-actions pb-2" style="border-bottom: 2px solid rgb(230, 230, 230);">
    <form class="action" mix-post="{{ url_for('add_comment') }}">
        <input type="hidden" name="post_pk" value="{{ tweet.post_pk }}">

        <textarea name="comment" id="comment_input_{{ tweet.post_pk }}" placeholder="Write a comment..."
            class="comment-input outline-1 pa-2 w-full rounded border-c-gray resize-none"></textarea>

        <button type="submit" mix-bottom="#comments_list_{{ tweet.post_pk }}" mix-default="Add Comment"
            mix-await="Posting..." class="w-auto ml-auto mt-2 bg-c-black text-c-white py-2 px-12 rounded-xl">
            Add Comment
        </button>
    </form>
</div>