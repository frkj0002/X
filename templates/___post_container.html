<form id="post_container" action="{{ url_for('api_create_post') }}" mix-post enctype="multipart/form-data" class="d-flex flex-col w-full ml-2">
    <textarea name="post" placeholder="What is new ?"
        class="w-full outline-1 outline-s-solid outline-c-gray:+50 pa-2"></textarea>
    <div id="image_preview" class="mt-2"></div>
    <div>
        <label for="upload_image" class="cursor-pointer">
            <i class="fa-solid fa-image"></i>
        </label>
        <input type="file" name="upload_image" id="upload_image">
    </div>
    <button mix-default="Post" mix-await="Posting ..."
        class="w-auto ml-auto mt-2 bg-c-black text-c-white py-2 px-12 rounded-xl">
        Post
    </button>
</form>


<script>
    document.getElementById("upload_image").addEventListener("change", function (event) {
        const container = document.getElementById("image_preview");
        // ryd tidligere preview
        container.innerHTML = "";

        const file = event.target.files[0];
        if (!file) return;

        // Tjek om det er et billede
        if (!file.type.startsWith("image/")) {
            container.textContent = "Filen er ikke et billede.";
            return;
        }

        const img = document.createElement("img");
        img.src = URL.createObjectURL(file);
        img.className = "w-80";

        container.appendChild(img);
    });
</script>